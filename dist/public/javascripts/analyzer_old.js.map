{"version":3,"sources":["../../../public/javascripts/analyzer_old.js"],"names":["id","$","text","video","current","duration","video0","get","playButton","muteButton","seekBar","volumeBar","overlay","inner","private_box","people_count","people_count_total","male_count","male_count_total","female_count","female_count_total","element_height","ratio","time","is_private","all_frame","remove_query","emotions","next_sec","getJSON","file","each","People","i","people","Frames","length","frame","Gender","Value","parseInt","document","ready","load","on","format","resize_overlay","fadeIn","propagate_info","canvas","getElementById","parent","width","offsetWidth","height","offsetHeight","ctx","getContext","myChart","Chart","type","data","labels","datasets","label","backgroundColor","borderColor","borderWidth","options","legend","position","responsive","maintainAspectRatio","scales","xAxes","display","yAxes","window","click","video_toggle","e","target","is","pause_video","create_emotion_chart","mousedown","hasClass","removeClass","addClass","prop","change","val","currentTime","remove","Math","floor","remove_create_emotion_chart","toggleClass","checked","play_video","pause","clearInterval","play","setInterval","fadeOut","frames","count","next_frame","FrameNumber","bb","BoundingBox","create_bb","propagate_emotion","bb_next","remove_overlay","abs","Top","Left","animate","top","left","queue","propagate_ppl_count","emotion","Emotions","Type","Confidence","overlay_bb","prepare_bb","gender","appendTo","new_overlay_bb","css","Width","Height","push","videoHeight","videoWidth","block","font","ticks","beginAtZero","min","max","callback","value","defaultFontFamily","s","ms","Number","String","split","m","toString","substring"],"mappings":"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","file":"analyzer_old.js","sourcesContent":["let id = $(\"#id\").text();\r\nlet video = $(\"#video\");\r\nlet current = $(\"#current\");\r\nlet duration = $(\"#duration\");\r\nlet video0 = video.get(0);\r\nlet playButton = $(\"#play-pause\");\r\nlet muteButton = $(\"#mute\");\r\nlet seekBar = $(\"#seek-bar\");\r\nlet volumeBar = $(\"#volume-bar\");\r\nlet overlay = $(\"#overlay-bg\");\r\nlet inner = $(\".overlay-inner\");\r\nlet private_box = $(\"#private_box\");\r\nlet people_count = $(\"#people_count\");\r\nlet people_count_total = $(\"#people_count_total\");\r\nlet male_count = $(\"#male_count\");\r\nlet male_count_total = $(\"#male_count_total\");\r\nlet female_count = $(\"#female_count\");\r\nlet female_count_total = $(\"#female_count_total\");\r\nlet element_height;\r\nlet ratio;\r\nlet time;\r\nlet is_private = false;\r\n\r\nlet all_frame = [];\r\nlet remove_query = [];\r\nlet emotions = [];\r\nlet next_sec = 0;\r\n\r\n$.getJSON(\"/upload/\" + id + \"/\" + id + \".json\", function (file) {\r\n    $.each(file.People, function (i, people) {\r\n        all_frame[i] = people.Frames;\r\n    });\r\n    people_count_total.text(file.People.length);\r\n    $.each(all_frame, function (i, frame) {\r\n        if (frame[0].Gender.Value === \"Male\") {\r\n            male_count_total.text(parseInt(male_count_total.text()) + 1);\r\n        } else {\r\n            female_count_total.text(parseInt(female_count_total.text()) + 1);\r\n        }\r\n    });\r\n});\r\n\r\n$(document).ready(function () {\r\n    video.get(0).load();\r\n    video.on(\"loadeddata\", function () {\r\n        duration.text(\"/ \" + format(video0.duration));\r\n        resize_overlay();\r\n        overlay.fadeIn(\"\");\r\n        propagate_info();\r\n    });\r\n    let canvas = document.getElementById(\"test\");\r\n    let parent = document.getElementById('parent');\r\n\r\n    canvas.width = parent.offsetWidth;\r\n    canvas.height = parent.offsetHeight;\r\n    let ctx = document.getElementById(\"test\").getContext('2d');\r\n    let myChart = new Chart(ctx, {\r\n        type: 'line',\r\n        data: {\r\n            labels: [\"Red\", \"Blue\", \"Yellow\", \"Green\", \"Purple\", \"Orange\"],\r\n            datasets: [{\r\n                label: 'Happy',\r\n                data: [10, 20, 30, 40,50,60,70,80,90],\r\n                backgroundColor: [\r\n                    'rgba(255, 99, 132, 0.2)'\r\n                ],\r\n                borderColor: [\r\n                    'rgba(255,99,132,1)'\r\n                ],\r\n                borderWidth: 1,\r\n                type: 'line'\r\n            }, {\r\n                label: 'Sad',\r\n                data: [50, 50, 50, 50,50,50,50,50,100],\r\n                backgroundColor: [\r\n                    'rgba(54, 162, 235, 0.2)'\r\n                ],\r\n                borderColor: [\r\n                    'rgba(54, 162, 235, 1)'\r\n                ],\r\n                borderWidth: 1,\r\n\r\n                // Changes this dataset to become a line\r\n                type: 'line'\r\n            }]\r\n        },\r\n        options: {\r\n            legend: {\r\n                position: 'right'\r\n            },\r\n            responsive: true,\r\n            maintainAspectRatio:false,\r\n            scales: {\r\n                xAxes: [{\r\n                    display: false\r\n                }],\r\n                yAxes: [{\r\n                    position: 'right'\r\n                }]\r\n            }\r\n        }\r\n    });\r\n});\r\n\r\n$(window).on(\"resize\", function () {\r\n    resize_overlay();\r\n});\r\n\r\nplayButton.click(function () {\r\n    video_toggle();\r\n});\r\noverlay.click(function (e) {\r\n    if ($(e.target).is('.overlay-inner') || $(e.target).is('.emotion_img')) {\r\n        pause_video();\r\n        create_emotion_chart(e.target);\r\n        return false;\r\n    } else {\r\n        video_toggle();\r\n    }\r\n});\r\nseekBar.mousedown(function () {\r\n    pause_video();\r\n});\r\n\r\nmuteButton.click(function () {\r\n    if ($(this).hasClass(\"fa-volume-off\")) {\r\n        $(this).removeClass(\"fa-volume-off\");\r\n        $(this).addClass(\"fa-volume-up\");\r\n        video.prop(\"muted\", false);\r\n    } else {\r\n        muteButton.removeClass(\"fa-volume-up\");\r\n        muteButton.addClass(\"fa-volume-off\");\r\n        video.prop(\"muted\", true);\r\n    }\r\n});\r\n\r\nvolumeBar.change(function () {\r\n    video.prop(\"volume\", $(this).val());\r\n});\r\n\r\n$(document).on(\"input\", \"#seek-bar\", function () {\r\n    video0.currentTime = video0.duration * seekBar.val();\r\n    $.each(all_frame, function (i) {\r\n        $(\"#\" + i).remove();\r\n    });\r\n    next_sec = Math.floor(video0.currentTime);\r\n    remove_query = [];\r\n    emotions = [];\r\n    propagate_info();\r\n    $(\"#current\").text(format(video0.currentTime));\r\n});\r\n\r\nprivate_box.change(function () {\r\n    remove_create_emotion_chart();\r\n    $(\".overlay-inner\").toggleClass(\"private\");\r\n    is_private = this.checked\r\n});\r\n\r\nfunction video_toggle() {\r\n    if (playButton.hasClass(\"fa-pause\")) {\r\n        pause_video();\r\n    } else {\r\n        play_video();\r\n    }\r\n}\r\n\r\nfunction pause_video() {\r\n    playButton.removeClass(\"fa-pause\");\r\n    playButton.addClass(\"fa-play\");\r\n    video0.pause();\r\n    clearInterval(time);\r\n}\r\n\r\nfunction play_video() {\r\n    playButton.removeClass(\"fa-play\");\r\n    playButton.addClass(\"fa-pause\");\r\n    inner.removeClass(\"showchart\");\r\n    remove_create_emotion_chart();\r\n    video0.play();\r\n    time = setInterval(function () {\r\n        seekBar.val((1 / video0.duration) * video0.currentTime);\r\n        current.text(format(video0.currentTime));\r\n        if (video0.currentTime === 0) next_sec = 0;\r\n        if (next_sec - video0.currentTime <= 0.1) {\r\n            propagate_info();\r\n            next_sec++;\r\n        }\r\n    }, 1);\r\n}\r\n\r\nfunction propagate_info() {\r\n    $.each(remove_query, function (i, overlay) {\r\n        if (overlay[1] === next_sec) {\r\n            $(\"#\" + overlay[0]).fadeOut(\"fast\", function () {\r\n                $(\"#\" + overlay[0]).remove();\r\n            });\r\n        }\r\n    });\r\n    $.each(all_frame, function (i, frames) {\r\n        for (let count = 0; count < frames.length; count++) {\r\n            let frame = frames[count];\r\n            let next_frame = frames[count + 1];\r\n            if (frame.FrameNumber === Math.floor(video0.currentTime + 2)) {\r\n                let bb = frame.BoundingBox;\r\n                create_bb(frame, i);\r\n                propagate_emotion(frame, i);\r\n                if (next_frame) {\r\n                    let bb_next = next_frame.BoundingBox;\r\n                    if (next_frame.FrameNumber - frame.FrameNumber > 2) {\r\n                        remove_overlay(i, next_sec);\r\n                    } else if (Math.abs(bb.Top - bb_next.Top) < 0.2 && Math.abs(bb.Left - bb_next.Left) < 0.2 && playButton.hasClass(\"fa-pause\")) {\r\n                        $(\"#\" + i).animate({\r\n                            top: bb_next.Top * 100 + \"%\",\r\n                            left: bb_next.Left * 100 + \"%\"\r\n                        }, {duration: 1000, queue: false}, function () {\r\n                            // Animation complete.\r\n                        });\r\n                    } else {\r\n                        remove_overlay(i, next_sec);\r\n                    }\r\n                } else remove_overlay(i, next_sec);\r\n            }\r\n        }\r\n    });\r\n    propagate_ppl_count();\r\n}\r\n\r\nfunction propagate_ppl_count() {\r\n    people_count.text($(\".overlay-inner\").length);\r\n    male_count.text($(\".male\").length);\r\n    female_count.text($(\".female\").length);\r\n}\r\n\r\nfunction propagate_emotion(frame, i) {\r\n    let emotion = frame.Emotions;\r\n    emotions[i] = {\r\n        labels: [emotion[0].Type, emotion[1].Type, emotion[2].Type],\r\n        datasets: [{\r\n            label: \"Percentage\",\r\n            data: [emotion[0].Confidence, emotion[1].Confidence, emotion[2].Confidence],\r\n            backgroundColor: [\r\n                'rgba(255, 99, 132, 0.2)',\r\n                'rgba(54, 162, 235, 0.2)',\r\n                'rgba(255, 206, 86, 0.2)'\r\n            ],\r\n            borderColor: [\r\n                'rgba(255,99,132,1)',\r\n                'rgba(54, 162, 235, 1)',\r\n                'rgba(255, 206, 86, 1)'\r\n            ],\r\n            borderWidth: 1\r\n        }]\r\n    };\r\n}\r\n\r\nfunction create_bb(frame, i) {\r\n    let bb = frame.BoundingBox;\r\n    let overlay_bb = $(\"#\" + i);\r\n    let prepare_bb = \"\";\r\n    let emotion = frame.Emotions[0].Type;\r\n    let gender = frame.Gender.Value;\r\n    if (overlay_bb.length) {\r\n        overlay_bb.remove();\r\n        prepare_bb += \"<div class='overlay-inner' id=\" + i + \">\";\r\n    } else {\r\n        prepare_bb += \"<div class='overlay-inner' style='display:none' id=\" + i + \">\";\r\n    }\r\n    prepare_bb += \"<img class='emotion_img' src='/images/emotion/\" + emotion + \"_\" + gender + \".png'>\";\r\n    prepare_bb += \"</div>\";\r\n    $(prepare_bb).appendTo(\"#overlay-bg\");\r\n    let new_overlay_bb = $(\"#\" + i);\r\n    if (is_private) {\r\n        new_overlay_bb.addClass(\"private\");\r\n    }\r\n    if (gender === \"Male\") {\r\n        new_overlay_bb.addClass(\"male\");\r\n    } else {\r\n        new_overlay_bb.addClass(\"female\");\r\n    }\r\n    new_overlay_bb.css({\"width\": bb.Width * 100 + \"%\"});\r\n    new_overlay_bb.css({\"height\": bb.Height * 100 + \"%\"});\r\n    new_overlay_bb.css({\"top\": bb.Top * 100 + \"%\"});\r\n    new_overlay_bb.css({\"left\": bb.Left * 100 + \"%\"});\r\n    new_overlay_bb.fadeIn(\"\");\r\n}\r\n\r\nfunction remove_overlay(i, next_sec) {\r\n    remove_query.push([i, next_sec + 1]);\r\n}\r\n\r\nfunction resize_overlay() {\r\n    element_height = video.height();\r\n    ratio = element_height / video0.videoHeight;\r\n    overlay.css({\"width\": video0.videoWidth * ratio + \"px\"});\r\n    overlay.css({\"height\": element_height + \"px\"});\r\n    let block = $(\".chart_block_overlay\");\r\n    block.css({\"top\": block.parent(\".overlay-inner\").height() + 3 + \"px\"});\r\n}\r\n\r\nfunction create_emotion_chart(target) {\r\n    remove_create_emotion_chart();\r\n    let id = target.id;\r\n    let block = $(\"<div class='chart_block_overlay' style='display:none'>Emotion<canvas id='chart_block_overlay' width='400' height='200'></canvas></div>\");\r\n    block.appendTo(target);\r\n    $(target).addClass(\"showchart\");\r\n    block.css({\"top\": $(target).height() + 3 + \"px\"});\r\n    if ($(target).css(\"left\") > \"40%\") {\r\n        block.addClass(\"left\");\r\n    } else {\r\n        block.addClass(\"right\");\r\n    }\r\n    block.fadeIn(\"\", function () {\r\n        let ctx = document.getElementById(\"chart_block_overlay\").getContext('2d');\r\n        ctx.font = \"Rajdhani\";\r\n        let myChart = new Chart(ctx, {\r\n            type: 'horizontalBar',\r\n            data: emotions[id],\r\n            options: {\r\n                scales: {\r\n                    yAxes: [{\r\n                        ticks: {\r\n                            beginAtZero: true\r\n                        }\r\n                    }],\r\n                    xAxes: [{\r\n                        ticks: {\r\n                            min: 0,\r\n                            max: 100,\r\n                            callback: function (value) {\r\n                                return value + \"%\"\r\n                            }\r\n                        },\r\n                    }]\r\n                },\r\n                legend: {\r\n                    display: false,\r\n                    labels: {\r\n                        // This more specific font property overrides the global property\r\n                        defaultFontFamily: \"Rajdhani\"\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction remove_create_emotion_chart() {\r\n    $(\".showchart\").removeClass(\"showchart\");\r\n    let overlay = $(\".chart_block_overlay\");\r\n    if (overlay.length) {\r\n        overlay.fadeOut(\"fast\", function () {\r\n            overlay.remove();\r\n        });\r\n    }\r\n}\r\n\r\nfunction format(s) {\r\n    ms = Number(String(s % 1).split(\".\")[1] || 0);\r\n    ms = (ms >= 100) ? ms : \"0\" + ms;\r\n    ms = (ms >= 10) ? ms : \"0\" + ms;\r\n    m = Math.floor(s / 60);\r\n    m = (m >= 10) ? m : \"0\" + m;\r\n    s = Math.floor(s % 60);\r\n    s = (s >= 10) ? s : \"0\" + s;\r\n    return m + \":\" + s + \":\" + ms.toString().substring(0, 3);\r\n}"]}