{"version":3,"sources":["../../../public/javascripts/analyzer.js"],"names":["id","$","text","video","current","duration","whole_video","video0","get","playButton","muteButton","seekBar","volumeBar","overlay","inner","private_box","people_count","people_count_total","male_count","male_count_total","female_count","female_count_total","element_height","ratio","interval","is_private","all_frame","remove_query","emotions","next_sec","total_emotion","emotion_time","happy","sad","angry","confused","disgusted","surprised","clam","emotion_per_frame","emotion_per_frame_config","data","datasets","backgroundColor","borderColor","labels","type","options","legend","position","fontColor","document","ready","load","on","format","fadeIn","getJSON","file","json","Result","sec","key","String","each","i","people","Emotions","Type","canvas","getElementById","parent","width","offsetWidth","height","offsetHeight","ctx","getContext","Chart","label","borderWidth","responsive","maintainAspectRatio","scales","xAxes","display","ticks","yAxes","userCallback","index","Math","floor","elements","point","radius","propagate_info","window","resize_overlay","resize","click","video_toggle","mouseup","e","is","target","pause_video","create_emotion_chart","toggleClass","hasClass","draggable","removeAttr","mousedown","removeClass","addClass","prop","change","val","currentTime","remove","remove_emotion_chart","checked","play_video","pause","clearInterval","play","setInterval","current_time","bb","BoundingBox","FaceId","create_bb","propagate_emotion_chart","next_people","bb_next","abs","Top","Left","Width","Height","animate","top","left","queue","push","propagate_ppl_count","update","length","emotion","Confidence","prepare_bb","gender","Gender","Value","appendTo","new_overlay_bb","css","videoHeight","videoWidth","block","myChart","beginAtZero","min","max","callback","value","fadeOut","s","ms","Number","split","m","toString","substring"],"mappings":"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","file":"analyzer.js","sourcesContent":["let id = $(\"#id\").text();\r\nlet video = $(\"#video\");\r\nlet current = $(\"#current\");\r\nlet duration = $(\"#duration\");\r\nlet whole_video = $(\"#whole_video\");\r\nlet video0 = video.get(0);\r\nlet playButton = $(\"#play-pause\");\r\nlet muteButton = $(\"#mute\");\r\nlet seekBar = $(\"#seek-bar\");\r\nlet volumeBar = $(\"#volume-bar\");\r\nlet overlay = $(\"#overlay-bg\");\r\nlet inner = $(\".overlay-inner\");\r\nlet private_box = $(\"#private_box\");\r\nlet people_count = $(\"#people_count\");\r\nlet people_count_total = $(\"#people_count_total\");\r\nlet male_count = $(\"#male_count\");\r\nlet male_count_total = $(\"#male_count_total\");\r\nlet female_count = $(\"#female_count\");\r\nlet female_count_total = $(\"#female_count_total\");\r\nlet element_height;\r\nlet ratio;\r\nlet interval;\r\nlet is_private = false;\r\n\r\nlet all_frame = [];\r\nlet remove_query = [];\r\nlet emotions = [];\r\nlet next_sec = 0;\r\n\r\nlet total_emotion;\r\nlet emotion_time = [];\r\nlet happy = [];\r\nlet sad = [];\r\nlet angry = [];\r\nlet confused = [];\r\nlet disgusted = [];\r\nlet surprised = [];\r\nlet clam = [];\r\n\r\nlet emotion_per_frame;\r\nlet emotion_per_frame_config = {\r\n    data: {\r\n        datasets: [{\r\n            backgroundColor: [\r\n                'rgba(255, 99, 132, 0.2)',\r\n                'rgba(54, 162, 235, 0.2)',\r\n                'rgba(255, 206, 86, 0.2)',\r\n                'rgba(75, 192, 192, 0.2)',\r\n                'rgba(153, 102, 255, 0.2)',\r\n                'rgba(255, 159, 64, 0.2)',\r\n                'rgba(54, 162, 235, 0.5)'\r\n            ],\r\n            borderColor: [\r\n                'rgba(255,99,132,1)',\r\n                'rgba(54, 162, 235, 1)',\r\n                'rgba(255, 206, 86, 1)',\r\n                'rgba(75, 192, 192, 1)',\r\n                'rgba(153, 102, 255, 1)',\r\n                'rgba(255, 159, 64, 1)',\r\n                'rgba(54, 162, 235, 1)'\r\n            ]\r\n        }],\r\n        // These labels appear in the legend and in the tooltips when hovering different arcs\r\n        labels: [\r\n            'Happy',\r\n            'Sad',\r\n            'Angry',\r\n            'Confused',\r\n            'Disgusted',\r\n            'Surprised',\r\n            'Clam'\r\n        ]\r\n\r\n    },\r\n    type: 'doughnut',\r\n    options: {\r\n        legend: {\r\n            position: 'right',\r\n            labels: {\r\n                fontColor: 'white'\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n$(document).ready(function () {\r\n    video.get(0).load();\r\n    video.on(\"loadeddata\", function () {\r\n        duration.text(\"/ \" + format(video0.duration));\r\n        overlay.fadeIn(\"\");\r\n        $.getJSON(\"/upload/\" + id + \"/\" + id + \".json\", function (file) {\r\n            let json = file.Result;\r\n            for (let sec = 0; sec <= video0.duration; sec++) {\r\n                emotion_time[sec] = sec;\r\n                happy[sec] = 0;\r\n                sad[sec] = 0;\r\n                angry[sec] = 0;\r\n                confused[sec] = 0;\r\n                disgusted[sec] = 0;\r\n                surprised[sec] = 0;\r\n                clam[sec] = 0;\r\n                let key = String(sec);\r\n                if (json[key]) {\r\n                    all_frame[sec] = json[key];\r\n                    $.each(all_frame[sec], function (i, people) {\r\n                        switch (people.Emotions[0].Type) {\r\n                            case \"HAPPY\":\r\n                                happy[sec]++;\r\n                                break;\r\n                            case \"SAD\":\r\n                                sad[sec]++;\r\n                                break;\r\n                            case \"ANGRY\":\r\n                                angry[sec]++;\r\n                                break;\r\n                            case \"CONFUSED\":\r\n                                confused[sec]++;\r\n                                break;\r\n                            case \"DISGUSTED\":\r\n                                disgusted[sec]++;\r\n                                break;\r\n                            case \"SURPRISED\":\r\n                                surprised[sec]++;\r\n                                break;\r\n                            case \"CLAM\":\r\n                                clam[sec]++;\r\n                                break;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            // people_count_total.text(file.People.length);\r\n            // $.each(all_frame, function (i, frame) {\r\n            //     if (frame[0].Gender.Value === \"Male\") {\r\n            //         male_count_total.text(parseInt(male_count_total.text()) + 1);\r\n            //     } else {\r\n            //         female_count_total.text(parseInt(female_count_total.text()) + 1);\r\n            //     }\r\n            // });\r\n\r\n            let canvas = document.getElementById(\"total_emotion\");\r\n            let parent = document.getElementById('parent');\r\n\r\n            canvas.width = parent.offsetWidth;\r\n            canvas.height = parent.offsetHeight;\r\n\r\n            let ctx = document.getElementById(\"total_emotion\").getContext('2d');\r\n            total_emotion = new Chart(ctx, {\r\n                type: 'line',\r\n                data: {\r\n                    labels: emotion_time,\r\n                    datasets: [{\r\n                        label: 'Happy',\r\n                        data: happy,\r\n                        backgroundColor: [\r\n                            'rgba(255, 99, 132, 0.2)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(255,99,132,1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }, {\r\n                        label: 'Sad',\r\n                        data: sad,\r\n                        backgroundColor: [\r\n                            'rgba(54, 162, 235, 0.2)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(54, 162, 235, 1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }, {\r\n                        label: 'Angry',\r\n                        data: angry,\r\n                        backgroundColor: [\r\n                            'rgba(255, 206, 86, 0.2)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(255, 206, 86, 1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }, {\r\n                        label: 'Confused',\r\n                        data: confused,\r\n                        backgroundColor: [\r\n                            'rgba(75, 192, 192, 0.2)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(75, 192, 192, 1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }, {\r\n                        label: 'Disgusted',\r\n                        data: disgusted,\r\n                        backgroundColor: [\r\n                            'rgba(153, 102, 255, 0.2)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(153, 102, 255, 1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }, {\r\n                        label: 'Surprised',\r\n                        data: surprised,\r\n                        backgroundColor: [\r\n                            'rgba(255, 159, 64, 0.2)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(255, 159, 64, 1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }, {\r\n                        label: 'Clam',\r\n                        data: clam,\r\n                        backgroundColor: [\r\n                            'rgba(54, 162, 235, 0.5)'\r\n                        ],\r\n                        borderColor: [\r\n                            'rgba(54, 162, 235, 1)'\r\n                        ],\r\n                        borderWidth: 1,\r\n                        type: 'line'\r\n                    }]\r\n                },\r\n                options: {\r\n                    legend: {\r\n                        position: 'right',\r\n                        labels: {\r\n                            fontColor: 'white'\r\n                        }\r\n                    },\r\n                    responsive: true,\r\n                    maintainAspectRatio: false,\r\n                    scales: {\r\n                        xAxes: [{\r\n                            display: false,\r\n                            ticks: {\r\n                                fontColor: 'white'\r\n                            }\r\n                        }],\r\n                        yAxes: [{\r\n                            position: 'right',\r\n                            ticks: {\r\n                                fontColor: 'white',\r\n                                userCallback: function (label, index, labels) {\r\n                                    // when the floored value is the same as the value we have a whole number\r\n                                    if (Math.floor(label) === label) {\r\n                                        return label;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }]\r\n                    },\r\n                    elements: {\r\n                        point: {\r\n                            radius: 0\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        propagate_info();\r\n    });\r\n    let ctx = document.getElementById(\"emotion_per_frame\").getContext('2d');\r\n    emotion_per_frame = new Chart(ctx, emotion_per_frame_config);\r\n});\r\n\r\n$(window).on(\"resize\", function () {\r\n    resize_overlay();\r\n});\r\n\r\nwhole_video.resize(function () {\r\n    resize_overlay();\r\n});\r\n\r\nplayButton.click(function () {\r\n    video_toggle();\r\n});\r\n\r\noverlay.mouseup(function (e) {\r\n    if (!whole_video.is('.ui-draggable-dragging')) {\r\n        if ($(e.target).is('.slider')) {\r\n            return false;\r\n        } else if ($(e.target).is('.overlay-inner') || $(e.target).is('.emotion_img')) {\r\n            pause_video();\r\n            create_emotion_chart(e.target);\r\n            return false;\r\n        } else if ($(e.target).is('#scale')) {\r\n            whole_video.toggleClass(\"col-12\");\r\n            whole_video.toggleClass(\"col-lg-7\");\r\n            whole_video.toggleClass(\"on_screen\");\r\n            if (whole_video.hasClass(\"on_screen\")) {\r\n                whole_video.draggable();\r\n            } else {\r\n                whole_video.draggable(\"destroy\");\r\n                whole_video.removeAttr('style');\r\n            }\r\n            return false;\r\n        } else {\r\n            video_toggle();\r\n        }\r\n    }\r\n});\r\n\r\nseekBar.mousedown(function () {\r\n    pause_video();\r\n});\r\n\r\nmuteButton.click(function () {\r\n    if ($(this).hasClass(\"fa-volume-off\")) {\r\n        $(this).removeClass(\"fa-volume-off\");\r\n        $(this).addClass(\"fa-volume-up\");\r\n        video.prop(\"muted\", false);\r\n    } else {\r\n        $(this).removeClass(\"fa-volume-up\");\r\n        $(this).addClass(\"fa-volume-off\");\r\n        video.prop(\"muted\", true);\r\n    }\r\n});\r\n\r\nvolumeBar.change(function () {\r\n    video.prop(\"volume\", $(this).val());\r\n});\r\n\r\n$(document).on(\"input\", \"#seek-bar\", function () {\r\n    video0.currentTime = video0.duration * seekBar.val();\r\n    $.each(all_frame, function (i) {\r\n        $(\".overlay-inner\").remove();\r\n    });\r\n    next_sec = Math.floor(video0.currentTime);\r\n    remove_query = [];\r\n    emotions = [];\r\n    $(\"#current\").text(format(video0.currentTime));\r\n    propagate_info();\r\n});\r\n\r\nprivate_box.change(function () {\r\n    remove_emotion_chart();\r\n    $(\".overlay-inner\").toggleClass(\"private\");\r\n    is_private = this.checked\r\n});\r\n\r\nfunction video_toggle() {\r\n    if (playButton.hasClass(\"fa-pause\")) {\r\n        pause_video();\r\n    } else {\r\n        play_video();\r\n    }\r\n}\r\n\r\nfunction pause_video() {\r\n    playButton.removeClass(\"fa-pause\");\r\n    playButton.addClass(\"fa-play\");\r\n    video0.pause();\r\n    clearInterval(interval);\r\n}\r\n\r\nfunction play_video() {\r\n    playButton.removeClass(\"fa-play\");\r\n    playButton.addClass(\"fa-pause\");\r\n    inner.removeClass(\"showchart\");\r\n    remove_emotion_chart();\r\n    video0.play();\r\n    interval = setInterval(function () {\r\n        seekBar.val((1 / video0.duration) * video0.currentTime);\r\n        current.text(format(video0.currentTime));\r\n        if (video0.currentTime === 0) next_sec = 0;\r\n        if (next_sec - video0.currentTime <= 0.1) {\r\n            propagate_info();\r\n            next_sec++;\r\n        }\r\n    }, 1);\r\n}\r\n\r\nfunction propagate_info() {\r\n    let current_time = Math.floor(video0.currentTime + 2);\r\n    $.each(remove_query, function (i, overlay) {\r\n        if (overlay[1] === next_sec) {\r\n            $(\"#\" + overlay[0]).remove();\r\n        }\r\n    });\r\n    if (all_frame[current_time]) {\r\n        $.each(all_frame[current_time], function (i, people) {\r\n            let bb = people.BoundingBox;\r\n            let id = people.FaceId;\r\n            create_bb(people, id);\r\n            propagate_emotion_chart(people, id);\r\n            if (all_frame[current_time + 1]) {\r\n                $.each(all_frame[current_time + 1], function (i, next_people) {\r\n                    let bb_next = next_people.BoundingBox;\r\n                    if (Math.abs(bb.Top - bb_next.Top) < 0.05\r\n                        && Math.abs(bb.Left - bb_next.Left) < 0.05\r\n                        && Math.abs(bb.Width - bb_next.Width) < 0.05\r\n                        && Math.abs(bb.Height - bb_next.Height) < 0.05\r\n                        && playButton.hasClass(\"fa-pause\")) {\r\n                        $(\"#\" + id).animate({\r\n                            top: bb_next.Top * 100 + \"%\",\r\n                            left: bb_next.Left * 100 + \"%\",\r\n                            width: bb_next.Width * 100 + \"%\",\r\n                            height: bb_next.Height * 100 + \"%\"\r\n                        }, {duration: 1000, queue: false}, function () {\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            remove_query.push([id, current_time]);\r\n        });\r\n    }\r\n    propagate_ppl_count();\r\n    let datasets = emotion_per_frame_config.data.datasets[0];\r\n    datasets.data[0] = happy[current_time];\r\n    datasets.data[1] = sad[current_time];\r\n    datasets.data[2] = angry[current_time];\r\n    datasets.data[3] = confused[current_time];\r\n    datasets.data[4] = disgusted[current_time];\r\n    datasets.data[5] = surprised[current_time];\r\n    datasets.data[6] = clam[current_time];\r\n    emotion_per_frame.update();\r\n}\r\n\r\nfunction propagate_ppl_count() {\r\n    people_count.text($(\".overlay-inner\").length);\r\n    male_count.text($(\".male\").length);\r\n    female_count.text($(\".female\").length);\r\n}\r\n\r\nfunction propagate_emotion_chart(people, id) {\r\n    let emotion = people.Emotions;\r\n    emotions[id] = {\r\n        labels: [emotion[0].Type, emotion[1].Type, emotion[2].Type],\r\n        datasets: [{\r\n            label: \"Percentage\",\r\n            data: [emotion[0].Confidence, emotion[1].Confidence, emotion[2].Confidence],\r\n            backgroundColor: [\r\n                'rgba(255, 99, 132, 0.2)',\r\n                'rgba(54, 162, 235, 0.2)',\r\n                'rgba(255, 206, 86, 0.2)'\r\n            ],\r\n            borderColor: [\r\n                'rgba(255,99,132,1)',\r\n                'rgba(54, 162, 235, 1)',\r\n                'rgba(255, 206, 86, 1)'\r\n            ],\r\n            borderWidth: 1\r\n        }]\r\n    };\r\n}\r\n\r\nfunction create_bb(people, id) {\r\n    let bb = people.BoundingBox;\r\n    let prepare_bb = \"\";\r\n    let emotion = people.Emotions[0].Type;\r\n    let gender = people.Gender.Value;\r\n    prepare_bb += \"<div class='overlay-inner' id=\" + id + \">\";\r\n    prepare_bb += \"<img class='emotion_img' src='/images/emotion/\" + emotion + \"_\" + gender + \".png'>\";\r\n    prepare_bb += \"</div>\";\r\n    $(prepare_bb).appendTo(\"#overlay-bg\");\r\n    let new_overlay_bb = $(\"#\" + id);\r\n    if (is_private) {\r\n        new_overlay_bb.addClass(\"private\");\r\n    }\r\n    if (gender === \"Male\") {\r\n        new_overlay_bb.addClass(\"male\");\r\n    } else {\r\n        new_overlay_bb.addClass(\"female\");\r\n    }\r\n    new_overlay_bb.css({\"width\": bb.Width * 100 + \"%\"});\r\n    new_overlay_bb.css({\"height\": bb.Height * 100 + \"%\"});\r\n    new_overlay_bb.css({\"top\": bb.Top * 100 + \"%\"});\r\n    new_overlay_bb.css({\"left\": bb.Left * 100 + \"%\"});\r\n}\r\n\r\nfunction resize_overlay() {\r\n    element_height = video.height();\r\n    ratio = element_height / video0.videoHeight;\r\n    overlay.css({\"width\": video0.videoWidth * ratio + \"px\", \"height\": element_height + \"px\"});\r\n    let block = $(\".chart_block_overlay\");\r\n    block.css({\"top\": block.parent(\".overlay-inner\").height() + 3 + \"px\"});\r\n}\r\n\r\nfunction create_emotion_chart(target) {\r\n    remove_emotion_chart();\r\n    let id = target.id;\r\n    let block = $(\"<div class='chart_block_overlay' style='display:none'>Emotion<canvas id='chart_block_overlay' width='400' height='200'></canvas></div>\");\r\n    block.appendTo(target);\r\n    $(target).addClass(\"showchart\");\r\n    block.css({\"top\": $(target).height() + 3 + \"px\"});\r\n    if ($(target).css(\"left\") > \"40%\") {\r\n        block.addClass(\"left\");\r\n    } else {\r\n        block.addClass(\"right\");\r\n    }\r\n    block.fadeIn(\"\", function () {\r\n        let ctx = document.getElementById(\"chart_block_overlay\").getContext('2d');\r\n        let myChart = new Chart(ctx, {\r\n            type: 'horizontalBar',\r\n            data: emotions[id],\r\n            options: {\r\n                scales: {\r\n                    yAxes: [{\r\n                        ticks: {\r\n                            beginAtZero: true,\r\n                            fontColor: 'white'\r\n                        }\r\n                    }],\r\n                    xAxes: [{\r\n                        ticks: {\r\n                            min: 0,\r\n                            max: 100,\r\n                            callback: function (value) {\r\n                                return value + \"%\"\r\n                            },\r\n                            fontColor: 'white'\r\n                        }\r\n                    }]\r\n                },\r\n                legend: {\r\n                    display: false\r\n                }\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\nfunction remove_emotion_chart() {\r\n    $(\".showchart\").removeClass(\"showchart\");\r\n    let overlay = $(\".chart_block_overlay\");\r\n    if (overlay.length) {\r\n        overlay.fadeOut(\"fast\", function () {\r\n            overlay.remove();\r\n        });\r\n    }\r\n}\r\n\r\nfunction format(s) {\r\n    ms = Number(String(s % 1).split(\".\")[1] || 0);\r\n    ms = (ms >= 100) ? ms : \"0\" + ms;\r\n    ms = (ms >= 10) ? ms : \"0\" + ms;\r\n    m = Math.floor(s / 60);\r\n    m = (m >= 10) ? m : \"0\" + m;\r\n    s = Math.floor(s % 60);\r\n    s = (s >= 10) ? s : \"0\" + s;\r\n    return m + \":\" + s + \":\" + ms.toString().substring(0, 3);\r\n}"]}